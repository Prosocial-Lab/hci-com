{"ast":null,"code":"import _slicedToArray from \"C:/Users/spenc/Documents/GitHub/hci-com/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"C:/Users/spenc/Documents/GitHub/hci-com/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\spenc\\\\Documents\\\\GitHub\\\\hci-com\\\\src\\\\containers\\\\Home\\\\components\\\\BubbleChart.tsx\",\n    _templateObject,\n    _s2 = $RefreshSig$();\n\nimport React, { useLayoutEffect, useState } from 'react';\nimport * as am4core from \"@amcharts/amcharts4/core\";\nimport am4themes_animated from \"@amcharts/amcharts4/themes/animated\";\nimport * as am4plugins_forceDirected from \"@amcharts/amcharts4/plugins/forceDirected\";\nimport styled from 'styled-components';\nimport axios from 'axios';\nimport './chart.css';\nimport Popover from 'react-bootstrap/Popover';\nimport Checkbox from \"react-custom-checkbox\";\nimport * as Icon from \"react-icons/fi\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar user_id = \"634739719\";\nam4core.useTheme(am4themes_animated);\nam4core.options.autoDispose = true;\nconst tweetpop = {\n  width: '400px',\n  maxWidth: 'none',\n  height: '600px',\n  maxHeight: '600px'\n};\nconst rcheck = {\n  color: '#9EFA99',\n  backgroundColor: '#9EFA99'\n};\nconst Check = styled.p(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n    &&& {\\n    padding: .05em;\\n    font-size: 24px;\\n}\"])));\n\nfunction Pop(data) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Popover, {\n      id: \"popover-basic\",\n      placement: \"top\",\n      style: tweetpop,\n      children: [/*#__PURE__*/_jsxDEV(Popover.Title, {\n        children: \"Sample Audience\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Popover.Content, {\n        children: data\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 45,\n    columnNumber: 3\n  }, this);\n}\n\n_c = Pop;\n\nfunction organizeData(data, num, active, series_dict) {\n  var new_data = [];\n  var num_coms = 0;\n\n  for (const key in active) {\n    if (active[key]) {\n      num_coms++;\n    }\n  }\n\n  if (num_coms > 0) {\n    num = Math.round(num / num_coms);\n  }\n\n  for (const key in data) {\n    if (!active[key]) {\n      continue;\n    } //console.log(\"Organizing\")\n\n\n    var i = 0;\n\n    for (const n in data[key]) {\n      i = i + 1;\n\n      if (i >= Object.keys(data[key]).length - num) {\n        new_data.push({\n          \"name\": String(n),\n          \"value\": data[key][n][\"number\"],\n          \"color\": series_dict[key]['col'],\n          \"sample\": data[key][n][\"audience_sample\"]\n        });\n      }\n    }\n  } //console.log(new_data)\n\n\n  return new_data;\n}\n\nfunction makeAudList(audience) {\n  var div = document.createElement(\"div\");\n\n  for (var i = 0; i < audience.length; i++) {\n    var h = document.createElement(\"h4\");\n    var node = document.createTextNode(audience[i][\"name\"]);\n    h.append(node);\n    var hsub = document.createElement(\"h5\");\n    var anchor = document.createElement(\"a\");\n    node = document.createTextNode(audience[i][\"id_text\"]);\n    anchor.append(node);\n    anchor.href = \"https://www.twitter.com/i/user/\" + audience[i][\"id_text\"];\n    anchor.target = \"_blank\";\n    anchor.rel = \"noopener noreferrer\";\n    hsub.append(anchor);\n    var p = document.createElement(\"p\");\n    node = document.createTextNode(audience[i][\"bio\"]);\n    p.appendChild(node);\n    div.append(h);\n    div.append(hsub);\n    div.append(p);\n  }\n\n  ;\n  return div;\n}\n\n;\n\nfunction displayPopup(chart, audience) {\n  chart.closeAllPopups();\n  var g = makeAudList(audience);\n  var gs = g.outerHTML;\n  chart.openPopup(gs, \"Sample users\");\n}\n\nfunction BubbleChart(props) {\n  _s2();\n\n  var _s = $RefreshSig$();\n\n  const full_data = props.data;\n\n  const _useState = useState({\n    \"r\": true,\n    \"p\": true,\n    \"o\": true\n  }),\n        _useState2 = _slicedToArray(_useState, 2),\n        activeComs = _useState2[0],\n        setActiveComs = _useState2[1]; //const [isLoading, setLoading] = useState(true);\n  //const [audience, setAudience] = useState([]);\n\n\n  var series_dict = props.series_dict;\n\n  const setState = key => {\n    var state = {\n      \"r\": activeComs[\"r\"],\n      \"p\": activeComs[\"p\"],\n      \"o\": activeComs[\"o\"]\n    };\n    state[key] = !state[key];\n    setActiveComs(state);\n  };\n  /*\r\n  var ids = []\r\n    for (var key in full_data){\r\n    for (var word in full_data[key]){\r\n      console.log(full_data[key][word][\"audience_sample\"])\r\n      ids.push(...full_data[key][word][\"audience_sample\"])\r\n    }\r\n  }\r\n  console.log(\"ids:\")\r\n  console.log(ids)\r\n  */\n\n\n  useLayoutEffect(_s(() => {\n    _s();\n\n    //chart.paddingRight = 20;\n    //chart.paddingLeft = 20;\n\n    /* Chart code */\n    // Themes begin\n    am4core.useTheme(am4themes_animated); // Themes end\n\n    var data0 = props.data; // Chart\n    //if (chart !== undefined) {chart.dispose()}\n\n    let chart = am4core.create(props.divid, am4plugins_forceDirected.ForceDirectedTree);\n    chart.hiddenState.properties.opacity = 0; // this creates initial fade-in\n\n    let series = chart.series.push(new am4plugins_forceDirected.ForceDirectedSeries());\n    console.log(chart.popups.template);\n    /*series.colors.list = [am4core.color(\"#000000\"),\r\n                          am4core.color(\"#000000\"),\r\n                          am4core.color(\"#000000\"),\r\n                          am4core.color(\"#000000\"),\r\n                          am4core.color(\"#000000\"),\r\n                          am4core.color(\"#000000\"),\r\n                          am4core.color(\"#000000\"),\r\n                          am4core.color(\"#000000\"),\r\n                          am4core.color(\"#000000\"),\r\n                          am4core.color(\"#000000\"),\r\n                          am4core.color(\"#000000\"),\r\n                          am4core.color(\"#000000\")];\r\n    series.colors.wrap = false;\r\n    */\n\n    series.dataFields.color = \"color\"; // Set data\n\n    series.data = [{\n      \"name\": \"First\",\n      \"value\": 190,\n      \"color\": am4core.color(\"#000000\")\n    }, {\n      \"name\": \"Second\",\n      \"value\": 289,\n      \"color\": am4core.color(\"#000000\")\n    }, {\n      \"name\": \"Third\",\n      \"value\": 635,\n      \"color\": am4core.color(\"#000000\")\n    }, {\n      \"name\": \"Fourth\",\n      \"value\": 732,\n      \"color\": am4core.color(\"#000000\")\n    }, {\n      \"name\": \"Fifth\",\n      \"value\": 835,\n      \"color\": am4core.color(\"#000000\")\n    }, {\n      \"name\": \"First\",\n      \"value\": 190,\n      \"color\": am4core.color(\"#9efa99\")\n    }, {\n      \"name\": \"Second\",\n      \"value\": 289,\n      \"color\": am4core.color(\"#9efa99\")\n    }, {\n      \"name\": \"Third\",\n      \"value\": 635,\n      \"color\": am4core.color(\"#9efa99\")\n    }, {\n      \"name\": \"Fourth\",\n      \"value\": 732,\n      \"color\": am4core.color(\"#9efa99\")\n    }, {\n      \"name\": \"Fifth\",\n      \"value\": 835,\n      \"color\": am4core.color(\"#9efa99\")\n    }]; // Set up data fields\n\n    series.dataFields.value = \"value\";\n    series.dataFields.name = \"name\";\n    series.dataFields.children = \"children\"; // Add labels\n\n    series.nodes.template.label.text = \"{name}\";\n    series.nodes.template.label.fill = am4core.color(\"#000000\");\n    series.fontSize = 10;\n    series.minRadius = 5;\n    series.maxRadius = 40;\n    series.manyBodyStrength = -8;\n    series.links.template.distance = 2;\n    series.links.template.strength = 2; //chart.cursorOverStyle = am4core.MouseCursorStyle.grab;\n\n    series.nodes.template.cursorOverStyle = am4core.MouseCursorStyle.grab;\n    series.cursorOverStyle = am4core.MouseCursorStyle.grab;\n    series.nodes.template.tooltipText = \"{name}: {value}\";\n    series.nodes.template.events.on(\"hit\", function (ev) {\n      var ids = ev.target.dataItem.dataContext['sample'];\n      axios.get(\"http://localhost:4001/twitter/audienceWhereIDs/\".concat(ids)).then(response => {\n        displayPopup(chart, response.data);\n      }).catch(error => console.error(\"There was an error retrieving the retweets list: \".concat(error)));\n      /*chart.modal.close();\r\n      \n      // get object info\r\n      console.log(ev.target.dataItem.dataContext['sample']);\r\n      //chart.openModal(ev.target.dataItem.dataContext['sample']);\r\n      //chart.openModal(\"<div>This is a <strong>strong</strong></div>\");\r\n      var g = makeAudList([])\r\n      var gs = g.outerHTML;\r\n      chart.openModal(gs);*/\n    });\n    series.data = organizeData(props.data, 60, activeComs, series_dict);\n  }, \"tFi1QeP7MrrEQ5RfFlomBKZonOc=\", false, function () {\n    return [am4core.useTheme];\n  }), [activeComs]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      id: props.divid,\n      style: {\n        width: \"100%\",\n        height: \"500px\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Checkbox, {\n      icon: /*#__PURE__*/_jsxDEV(Icon.FiCheck, {\n        color: \"#000000\",\n        size: 14\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 15\n      }, this),\n      name: \"my-input\",\n      checked: true,\n      onChange: value => {\n        setState(\"r\");\n      },\n      borderColor: \"#9EFA99\",\n      borderWidth: \"3\",\n      style: {\n        cursor: \"pointer\"\n      },\n      labelStyle: {\n        marginLeft: 5,\n        userSelect: \"none\",\n        fontSize: \"18px\"\n      },\n      label: \"Researchers\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Checkbox, {\n      icon: /*#__PURE__*/_jsxDEV(Icon.FiCheck, {\n        color: \"#000000\",\n        size: 14\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 15\n      }, this),\n      name: \"my-input\",\n      checked: true,\n      onChange: value => {\n        setState(\"p\");\n      },\n      borderColor: \"#FA999E\",\n      borderWidth: \"3\",\n      style: {\n        cursor: \"pointer\"\n      },\n      labelStyle: {\n        marginLeft: 5,\n        userSelect: \"none\",\n        fontSize: \"18px\"\n      },\n      label: \"Practitioners\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Checkbox, {\n      icon: /*#__PURE__*/_jsxDEV(Icon.FiCheck, {\n        color: \"#000000\",\n        size: 14\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 15\n      }, this),\n      name: \"my-input\",\n      checked: true,\n      onChange: value => {\n        setState(\"o\");\n      },\n      borderColor: \"#999EFA\",\n      borderWidth: \"3\",\n      style: {\n        cursor: \"pointer\"\n      },\n      labelStyle: {\n        marginLeft: 5,\n        userSelect: \"none\",\n        fontSize: \"18px\"\n      },\n      label: \"Other Publics\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 280,\n    columnNumber: 5\n  }, this);\n}\n\n_s2(BubbleChart, \"lHkKmuV/E5Eet8m6WzuhPfqGSk4=\");\n\n_c2 = BubbleChart;\nexport default BubbleChart;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Pop\");\n$RefreshReg$(_c2, \"BubbleChart\");","map":{"version":3,"sources":["C:/Users/spenc/Documents/GitHub/hci-com/src/containers/Home/components/BubbleChart.tsx"],"names":["React","useLayoutEffect","useState","am4core","am4themes_animated","am4plugins_forceDirected","styled","axios","Popover","Checkbox","Icon","user_id","useTheme","options","autoDispose","tweetpop","width","maxWidth","height","maxHeight","rcheck","color","backgroundColor","Check","p","Pop","data","organizeData","num","active","series_dict","new_data","num_coms","key","Math","round","i","n","Object","keys","length","push","String","makeAudList","audience","div","document","createElement","h","node","createTextNode","append","hsub","anchor","href","target","rel","appendChild","displayPopup","chart","closeAllPopups","g","gs","outerHTML","openPopup","BubbleChart","props","full_data","activeComs","setActiveComs","setState","state","data0","create","divid","ForceDirectedTree","hiddenState","properties","opacity","series","ForceDirectedSeries","console","log","popups","template","dataFields","value","name","children","nodes","label","text","fill","fontSize","minRadius","maxRadius","manyBodyStrength","links","distance","strength","cursorOverStyle","MouseCursorStyle","grab","tooltipText","events","on","ev","ids","dataItem","dataContext","get","then","response","catch","error","cursor","marginLeft","userSelect"],"mappings":"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","sourcesContent":["import React, { useRef, useLayoutEffect, useState } from 'react';\r\nimport ReactDom from 'react-dom';\r\nimport logo from './logo.svg';\r\nimport * as am4core from \"@amcharts/amcharts4/core\";\r\nimport * as am4charts from \"@amcharts/amcharts4/charts\";\r\nimport am4themes_animated from \"@amcharts/amcharts4/themes/animated\";\r\nimport * as am4plugins_forceDirected from \"@amcharts/amcharts4/plugins/forceDirected\";\r\nimport styled from 'styled-components';\r\nimport {space, color, layout} from 'styled-system';\r\nimport Card from 'react-bootstrap/Card';\r\nimport axios from 'axios'\r\nimport './chart.css';\r\nimport Popover from 'react-bootstrap/Popover'\r\nimport Checkbox from \"react-custom-checkbox\";\r\nimport * as Icon from \"react-icons/fi\";\r\n\r\nvar user_id = \"634739719\";\r\n\r\nam4core.useTheme(am4themes_animated);\r\nam4core.options.autoDispose = true;\r\n\r\nconst tweetpop = {\r\n  width: '400px',\r\n  maxWidth: 'none',\r\n  height: '600px',\r\n  maxHeight: '600px'\r\n  \r\n};\r\n\r\nconst rcheck = {\r\n  color: '#9EFA99',\r\n  backgroundColor: '#9EFA99'\r\n\r\n}\r\n\r\nconst Check = styled.p`\r\n    &&& {\r\n    padding: .05em;\r\n    font-size: 24px;\r\n}`\r\n\r\nfunction Pop(data){\r\n  return(\r\n\r\n  <div>\r\n    <Popover id=\"popover-basic\" placement=\"top\" style={tweetpop}>\r\n      <Popover.Title>Sample Audience</Popover.Title>\r\n      <Popover.Content>\r\n          {data}\r\n      </Popover.Content>\r\n    </Popover>\r\n  </div>\r\n\r\n  )\r\n}\r\n\r\n\r\nfunction organizeData(data, num, active, series_dict){\r\n  var new_data = []\r\n  var num_coms = 0\r\n  for (const key in active){\r\n    if (active[key]){\r\n      num_coms++\r\n    }\r\n  }\r\n  if (num_coms > 0){\r\n    num = Math.round(num / num_coms)\r\n  }\r\n  \r\n  for (const key in data){\r\n    if (!active[key]){\r\n      continue\r\n    }\r\n    //console.log(\"Organizing\")\r\n    var i = 0\r\n    for (const n in data[key]){\r\n      i = i + 1\r\n      if (i >= Object.keys(data[key]).length - num){\r\n        new_data.push({\"name\": String(n),\r\n                     \"value\": data[key][n][\"number\"],\r\n                    \"color\": series_dict[key]['col'],\r\n                    \"sample\": data[key][n][\"audience_sample\"]})\r\n      }\r\n      \r\n    }\r\n  }\r\n  //console.log(new_data)\r\n  return (new_data)\r\n}\r\n\r\nfunction makeAudList(audience) {\r\n  var div = document.createElement(\"div\")\r\n  for (var i = 0; i < audience.length; i++) {\r\n    \r\n    var h = document.createElement(\"h4\")\r\n    var node = document.createTextNode(audience[i][\"name\"])\r\n    h.append(node)\r\n\r\n    var hsub = document.createElement(\"h5\")\r\n  \r\n    var anchor = document.createElement(\"a\")\r\n    node = document.createTextNode(audience[i][\"id_text\"])\r\n    anchor.append(node)\r\n    anchor.href = \"https://www.twitter.com/i/user/\" + audience[i][\"id_text\"]\r\n    anchor.target = \"_blank\"\r\n    anchor.rel = \"noopener noreferrer\"\r\n    hsub.append(anchor)\r\n\r\n    var p = document.createElement(\"p\")\r\n    node = document.createTextNode(audience[i][\"bio\"]);\r\n\r\n    p.appendChild(node)\r\n    div.append(h)\r\n    div.append(hsub)\r\n    div.append(p)\r\n  };\r\n  return div\r\n};\r\n\r\nfunction displayPopup(chart, audience) {\r\n  \r\n  chart.closeAllPopups();\r\n \r\n  var g = makeAudList(audience)\r\n  var gs = g.outerHTML;\r\n  chart.openPopup(gs, \"Sample users\");\r\n}\r\n\r\nfunction BubbleChart(props) {\r\n  const full_data = props.data\r\n  const [activeComs, setActiveComs] = useState({\"r\": true, \"p\": true, \"o\": true})\r\n\r\n  //const [isLoading, setLoading] = useState(true);\r\n  //const [audience, setAudience] = useState([]);\r\n  var series_dict = props.series_dict\r\n\r\n  const setState = (key) => {\r\n    var state = {\"r\": activeComs[\"r\"], \"p\": activeComs[\"p\"], \"o\": activeComs[\"o\"]}\r\n    state[key] = !state[key]\r\n    setActiveComs(state)\r\n  }\r\n  /*\r\n  var ids = []\r\n\r\n  for (var key in full_data){\r\n    for (var word in full_data[key]){\r\n      console.log(full_data[key][word][\"audience_sample\"])\r\n      ids.push(...full_data[key][word][\"audience_sample\"])\r\n    }\r\n  }\r\n  console.log(\"ids:\")\r\n  console.log(ids)\r\n  */\r\n\r\n  useLayoutEffect(() => {\r\n\r\n    //chart.paddingRight = 20;\r\n    //chart.paddingLeft = 20;\r\n\r\n    /* Chart code */\r\n// Themes begin\r\nam4core.useTheme(am4themes_animated);\r\n// Themes end\r\n\r\nvar data0 = props.data\r\n\r\n// Chart\r\n//if (chart !== undefined) {chart.dispose()}\r\nlet chart = am4core.create(props.divid, am4plugins_forceDirected.ForceDirectedTree); \r\nchart.hiddenState.properties.opacity = 0; // this creates initial fade-in\r\n\r\nlet series = chart.series.push(new am4plugins_forceDirected.ForceDirectedSeries())\r\n\r\nconsole.log(chart.popups.template)\r\n\r\n/*series.colors.list = [am4core.color(\"#000000\"),\r\n                      am4core.color(\"#000000\"),\r\n                      am4core.color(\"#000000\"),\r\n                      am4core.color(\"#000000\"),\r\n                      am4core.color(\"#000000\"),\r\n                      am4core.color(\"#000000\"),\r\n                      am4core.color(\"#000000\"),\r\n                      am4core.color(\"#000000\"),\r\n                      am4core.color(\"#000000\"),\r\n                      am4core.color(\"#000000\"),\r\n                      am4core.color(\"#000000\"),\r\n                      am4core.color(\"#000000\")];\r\nseries.colors.wrap = false;\r\n*/\r\nseries.dataFields.color = \"color\";\r\n// Set data\r\nseries.data = [{\r\n  \"name\": \"First\",\r\n  \"value\": 190,\r\n  \"color\": am4core.color(\"#000000\")\r\n}, {\r\n  \"name\": \"Second\",\r\n  \"value\": 289,\r\n  \"color\": am4core.color(\"#000000\")\r\n}, {\r\n  \"name\": \"Third\",\r\n  \"value\": 635,\r\n  \"color\": am4core.color(\"#000000\")\r\n}, {\r\n  \"name\": \"Fourth\",\r\n  \"value\": 732,\r\n  \"color\": am4core.color(\"#000000\")\r\n}, {\r\n  \"name\": \"Fifth\",\r\n  \"value\": 835,\r\n  \"color\": am4core.color(\"#000000\")\r\n}, {\r\n  \"name\": \"First\",\r\n  \"value\": 190,\r\n  \"color\": am4core.color(\"#9efa99\")\r\n}, {\r\n  \"name\": \"Second\",\r\n  \"value\": 289,\r\n  \"color\": am4core.color(\"#9efa99\")\r\n}, {\r\n  \"name\": \"Third\",\r\n  \"value\": 635,\r\n  \"color\": am4core.color(\"#9efa99\")\r\n}, {\r\n  \"name\": \"Fourth\",\r\n  \"value\": 732,\r\n  \"color\": am4core.color(\"#9efa99\")\r\n}, {\r\n  \"name\": \"Fifth\",\r\n  \"value\": 835,\r\n  \"color\": am4core.color(\"#9efa99\")\r\n}]\r\n\r\n// Set up data fields\r\nseries.dataFields.value = \"value\";\r\nseries.dataFields.name = \"name\";\r\nseries.dataFields.children = \"children\";\r\n\r\n// Add labels\r\nseries.nodes.template.label.text = \"{name}\";\r\nseries.nodes.template.label.fill = am4core.color(\"#000000\")\r\nseries.fontSize = 10;\r\nseries.minRadius = 5;\r\nseries.maxRadius = 40;\r\n\r\nseries.manyBodyStrength = -8;\r\nseries.links.template.distance = 2;\r\nseries.links.template.strength = 2;\r\n\r\n//chart.cursorOverStyle = am4core.MouseCursorStyle.grab;\r\nseries.nodes.template.cursorOverStyle = am4core.MouseCursorStyle.grab;\r\nseries.cursorOverStyle = am4core.MouseCursorStyle.grab;\r\n\r\nseries.nodes.template.tooltipText = \"{name}: {value}\";\r\nseries.nodes.template.events.on(\"hit\", function(ev) {\r\n  var ids = ev.target.dataItem.dataContext['sample']\r\n  axios\r\n        .get(`http://localhost:4001/twitter/audienceWhereIDs/${ids}`)\r\n        .then(response => {\r\n          displayPopup(chart, response.data)\r\n        })\r\n        .catch(error => console.error(`There was an error retrieving the retweets list: ${error}`));\r\n  /*chart.modal.close();\r\n \r\n  // get object info\r\n  console.log(ev.target.dataItem.dataContext['sample']);\r\n  //chart.openModal(ev.target.dataItem.dataContext['sample']);\r\n  //chart.openModal(\"<div>This is a <strong>strong</strong></div>\");\r\n  var g = makeAudList([])\r\n  var gs = g.outerHTML;\r\n  chart.openModal(gs);*/\r\n});\r\n\r\nseries.data = organizeData(props.data, 60, activeComs, series_dict)\r\n\r\n\r\n  }, [activeComs]);\r\n\r\n  return (\r\n    <div>\r\n        <div id={props.divid} style={{ width: \"100%\", height: \"500px\" }}></div>\r\n        <Checkbox\r\n        icon={<Icon.FiCheck color=\"#000000\" size={14} />}\r\n        name=\"my-input\"\r\n        checked={true}\r\n        onChange={(value) => {setState(\"r\")}}\r\n        borderColor=\"#9EFA99\"\r\n        borderWidth='3'\r\n        style={{ cursor: \"pointer\" }}\r\n        labelStyle={{ marginLeft: 5, userSelect: \"none\", fontSize: \"18px\"}}\r\n        label=\"Researchers\"\r\n      />\r\n      <Checkbox\r\n        icon={<Icon.FiCheck color=\"#000000\" size={14} />}\r\n        name=\"my-input\"\r\n        checked={true}\r\n        onChange={(value) => {setState(\"p\")}}\r\n        borderColor=\"#FA999E\"\r\n        borderWidth='3'\r\n        style={{ cursor: \"pointer\" }}\r\n        labelStyle={{ marginLeft: 5, userSelect: \"none\", fontSize: \"18px\" }}\r\n        label=\"Practitioners\"\r\n      />\r\n      <Checkbox\r\n        icon={<Icon.FiCheck color=\"#000000\" size={14} />}\r\n        name=\"my-input\"\r\n        checked={true}\r\n        onChange={(value) => {setState(\"o\")}}\r\n        borderColor=\"#999EFA\"\r\n        borderWidth='3'\r\n        style={{ cursor: \"pointer\" }}\r\n        labelStyle={{ marginLeft: 5, userSelect: \"none\", fontSize: \"18px\" }}\r\n        label=\"Other Publics\"\r\n      />\r\n    </div>\r\n    \r\n  );\r\n}\r\nexport default BubbleChart;"]},"metadata":{},"sourceType":"module"}