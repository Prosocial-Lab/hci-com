{"ast":null,"code":"import _createForOfIteratorHelper from \"C:/Users/spenc/Documents/GitHub/hci-com/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\spenc\\\\Documents\\\\GitHub\\\\hci-com\\\\src\\\\containers\\\\Home\\\\components\\\\WaffleChart.tsx\",\n    _s2 = $RefreshSig$();\n\nimport React, { useRef, useLayoutEffect } from 'react';\nimport * as am4core from \"@amcharts/amcharts4/core\";\nimport * as am4charts from \"@amcharts/amcharts4/charts\";\nimport am4themes_animated from \"@amcharts/amcharts4/themes/animated\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar user_id = \"634739719\";\nam4core.useTheme(am4themes_animated);\n\nfunction WaffleProportionAny(ns) {\n  var datas = [];\n  var vals = [];\n\n  var _iterator = _createForOfIteratorHelper(ns),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      let n = _step.value;\n      vals.push(n.valueOf());\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  var l = vals.length;\n  var tot = vals.reduce((a, b) => a + b, 0);\n  var num_cols = parseInt(Math.sqrt(tot / 50).toFixed());\n  num_cols = Math.max(3, num_cols);\n  num_cols = Math.min(30, num_cols);\n  var num_cells = num_cols * num_cols;\n  var nums = [];\n  var last = 0;\n\n  for (let i = 0; i < l; i++) {\n    var num = vals[i] / tot;\n    nums.push(num);\n    last = num + last;\n  }\n\n  var strs = [];\n\n  for (let i = 0; i < l; i++) {\n    strs.push((nums[i] * num_cells).toFixed());\n  }\n\n  var rs = [];\n\n  for (let i = 0; i < l; i++) {\n    rs.push(parseInt(strs[i]));\n  }\n\n  var row = 1;\n  var col = 1;\n  var new_data_x = [];\n  var new_data_y = [];\n\n  for (let i = 1; i <= num_cols; i++) {\n    new_data_x.push({\n      x: i.toString()\n    });\n  }\n\n  for (let i = 1; i <= num_cols; i++) {\n    new_data_y.push({\n      y: i.toString()\n    });\n  }\n\n  var r_tot = 0;\n\n  for (let h = 0; h <= l - 1; h++) {\n    var data = [];\n\n    for (let i = r_tot; i < r_tot + rs[h]; i++) {\n      var x_str = row.toString();\n      var y_str = col.toString();\n      data.push({\n        x: x_str,\n        y: y_str\n      });\n\n      if (col == num_cols) {\n        row = row + 1;\n        col = 1;\n      } else {\n        col = col + 1;\n      }\n    }\n\n    datas.push(data);\n    r_tot = r_tot + rs[h];\n  }\n\n  var data = [];\n\n  for (let i = r_tot; i < num_cells; i++) {\n    var x_str = row.toString();\n    var y_str = col.toString();\n    data.push({\n      x: x_str,\n      y: y_str\n    });\n\n    if (col == num_cols) {\n      row = row + 1;\n      col = 1;\n    } else {\n      col = col + 1;\n    }\n  }\n\n  datas.push(data);\n  return {\n    data_list: datas,\n    data_x: new_data_x,\n    data_y: new_data_y\n  };\n}\n\n_c = WaffleProportionAny;\n\nfunction WaffleProportionCheat(n, m) {\n  var data1 = [];\n  var data2 = [];\n  var x_val = n.valueOf();\n  var y_val = m.valueOf();\n  var tot = x_val + y_val;\n  var num_cols = parseInt(Math.sqrt(tot / 50).toFixed());\n  num_cols = Math.max(3, num_cols);\n  num_cols = Math.min(30, num_cols);\n  var num_cells = num_cols * num_cols;\n  var num1 = x_val / tot;\n  var num2 = 1 - num1;\n  var s1 = (num1 * num_cells).toFixed();\n  var s2 = (num2 * num_cells).toFixed();\n  var r1 = parseInt(s1);\n  var r2 = parseInt(s2);\n  var row = 1;\n  var col = 1;\n  var new_data_x = [];\n  var new_data_y = [];\n\n  for (let i = 1; i <= num_cols; i++) {\n    new_data_x.push({\n      x: i.toString()\n    });\n  }\n\n  for (let i = 1; i <= num_cols; i++) {\n    new_data_y.push({\n      y: i.toString()\n    });\n  }\n\n  for (let i = 0; i < r1; i++) {\n    var x_str = row.toString();\n    var y_str = col.toString();\n    data1.push({\n      x: x_str,\n      y: y_str\n    });\n\n    if (col == num_cols) {\n      row = row + 1;\n      col = 1;\n    } else {\n      col = col + 1;\n    }\n  }\n\n  for (let i = r1; i < num_cells; i++) {\n    var x_str = row.toString();\n    var y_str = col.toString();\n    data2.push({\n      x: x_str,\n      y: y_str\n    });\n\n    if (col == num_cols) {\n      row = row + 1;\n      col = 1;\n    } else {\n      col = col + 1;\n    }\n  }\n\n  return [data1, data2, new_data_x, new_data_y];\n}\n\n_c2 = WaffleProportionCheat;\n\nfunction WaffleProportion(n, m) {\n  var data1 = [];\n  var data2 = [];\n  var x_val = n.valueOf();\n  var y_val = m.valueOf();\n  var tot = x_val + y_val;\n  var num1 = x_val / tot;\n  var num2 = tot - num1;\n  var s1 = num1.toFixed();\n  var s2 = num2.toFixed();\n  var r1 = parseInt(s1);\n  var r2 = parseInt(s2);\n  var row = 1;\n  var col = 1;\n\n  for (let i = 0; i < r1; i++) {\n    var x_str = row.toString();\n    var y_str = col.toString();\n    data1.push({\n      x: x_str,\n      y: y_str\n    });\n\n    if (col == 10) {\n      row = row + 1;\n      col = 1;\n    } else {\n      col = col + 1;\n    }\n  }\n\n  for (let i = r1; i < 100; i++) {\n    var x_str = row.toString();\n    var y_str = col.toString();\n    data2.push({\n      x: x_str,\n      y: y_str\n    });\n\n    if (col == 10) {\n      row = row + 1;\n      col = 1;\n    } else {\n      col = col + 1;\n    }\n  }\n\n  return [data1, data2];\n}\n\n_c3 = WaffleProportion;\n\nfunction WaffleChart(props) {\n  _s2();\n\n  var _s = $RefreshSig$();\n\n  const chart = useRef(null);\n  var rs = 3600;\n  var nrs = 6400;\n  useLayoutEffect(_s(() => {\n    _s();\n\n    let x = am4core.create(props.divid, am4charts.XYChart);\n    x.paddingRight = 20;\n    x.paddingLeft = 20;\n    /* Chart code */\n    // Themes begin\n\n    am4core.useTheme(am4themes_animated); // Themes end\n    // Chart\n\n    let chart = am4core.create(props.divid, am4charts.XYChart);\n    chart.hiddenState.properties.opacity = 0; // this creates initial fade-in\n    //chart.colors.step = 2;\n\n    switch (props.scheme) {\n      case \"followers\":\n        {\n          chart.colors.list = [am4core.color(\"#98a2df\"), am4core.color(\"#e96b6a\"), am4core.color(\"#a2df98\")];\n          break;\n        }\n\n      case \"tweets\":\n        {\n          chart.colors.list = [am4core.color(\"#CF30B2\"), am4core.color(\"#30B2CF\"), am4core.color(\"#B2CF30\")];\n          break;\n        }\n\n      default:\n        {\n          chart.colors.list = [am4core.color(\"#98a2df\"), am4core.color(\"#e96b6a\"), am4core.color(\"#a2df98\")];\n        }\n    } //chart.colors.list = [am4core.color( \"#98a2df\" ), am4core.color( \"#e96b6a\" ), am4core.color(\"#a2df98\")]\n    // X axis\n\n\n    let xAxis = chart.xAxes.push(new am4charts.CategoryAxis());\n    xAxis.dataFields.category = \"x\";\n    xAxis.renderer.grid.template.location = 0;\n    xAxis.renderer.minGridDistance = 10;\n    xAxis.renderer.labels.template.disabled = true;\n    xAxis.data = [{\n      x: \"1\"\n    }, {\n      x: \"2\"\n    }, {\n      x: \"3\"\n    }, {\n      x: \"4\"\n    }, {\n      x: \"5\"\n    }, {\n      x: \"6\"\n    }, {\n      x: \"7\"\n    }, {\n      x: \"8\"\n    }, {\n      x: \"9\"\n    }, {\n      x: \"10\"\n    }]; // Y axis\n\n    let yAxis = chart.yAxes.push(new am4charts.CategoryAxis());\n    yAxis.renderer.labels.template.disabled = true;\n    yAxis.renderer.grid.template.location = 0;\n    yAxis.renderer.minGridDistance = 10;\n    yAxis.dataFields.category = \"y\";\n    yAxis.data = [{\n      y: \"1\"\n    }, {\n      y: \"2\"\n    }, {\n      y: \"3\"\n    }, {\n      y: \"4\"\n    }, {\n      y: \"5\"\n    }, {\n      y: \"6\"\n    }, {\n      y: \"7\"\n    }, {\n      y: \"8\"\n    }, {\n      y: \"9\"\n    }, {\n      y: \"10\"\n    }]; // Create series\n\n    function createSeries(name) {\n      let series = chart.series.push(new am4charts.ColumnSeries());\n      series.dataFields.categoryX = \"x\";\n      series.dataFields.categoryY = \"y\";\n      series.sequencedInterpolation = true;\n      series.defaultState.transitionDuration = 3000;\n      series.name = name; // Set up column appearance\n\n      let column = series.columns.template;\n      column.strokeWidth = 1;\n      column.strokeOpacity = 1;\n      column.fillOpacity = 1;\n      column.stroke = am4core.color(\"#ffffff\");\n      column.width = am4core.percent(100);\n      column.height = am4core.percent(100); //column.column.cornerRadius(6, 6, 6, 6);\n\n      let hs = series.columns.template.states.create(\"active\");\n      hs.properties.fillOpacity = 0.5;\n      return series;\n    }\n\n    let series_list = [];\n    let vars = props.vars;\n    let nums_list = [];\n    let denom = 0;\n\n    for (let i = 0; i < vars.length; i++) {\n      var num = new Number();\n      num = vars[i]['data'];\n      denom = denom + vars[i]['data'];\n      nums_list.push(num);\n    }\n\n    for (let i = 0; i < vars.length; i++) {\n      var percent = vars[i]['data'] / denom;\n      var rat = (percent * 100).toFixed(1).toString();\n      series_list.push(createSeries(vars[i]['name'] + \": \" + rat + \"% (\" + nums_list[i].toString() + \")\"));\n    }\n\n    var datas = WaffleProportionAny(nums_list);\n\n    for (let i = 0; i < vars.length; i++) {\n      series_list[i].data = datas['data_list'][i];\n    }\n\n    xAxis.data = datas['data_x'];\n    yAxis.data = datas['data_y']; // Legend\n\n    chart.legend = new am4charts.Legend();\n    chart.legend.scrollable = true;\n    chart.legend.maxWidth = 50;\n    chart.legend.itemContainers.template.tooltipText = \"{name}\";\n\n    switch (props.legend_pos) {\n      case \"right\":\n        {\n          chart.legend.position = \"right\";\n          break;\n        }\n\n      case \"left\":\n        {\n          chart.legend.position = \"left\";\n          break;\n        }\n\n      case \"top\":\n        {\n          chart.legend.position = \"top\";\n          break;\n        }\n\n      case \"bottom\":\n        {\n          chart.legend.position = \"bottom\";\n          break;\n        }\n\n      default:\n        {\n          chart.legend.position = \"right\";\n          break;\n        }\n    } //Custom code for legend\n\n\n    chart.legend.itemContainers.template.togglable = false;\n    var series_dict = {};\n    var keys = [];\n\n    for (let i = 0; i < vars.length; i++) {\n      var key = series_list[i].name;\n      series_dict[key] = series_list[i]['columns']['template'];\n      keys.push(key);\n    }\n\n    chart.legend.itemContainers.template.events.on(\"hit\", function (ev) {\n      let seriesColumn = ev.target.dataItem.dataContext['columns']['template'];\n      let sname = ev.target.dataItem.dataContext['name'];\n      let other_series = [];\n\n      var _iterator2 = _createForOfIteratorHelper(keys),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          let k = _step2.value;\n\n          if (sname != k) {\n            other_series.push(series_dict[k]);\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n\n      if (other_series[0].isActive) {\n        other_series.map(function (e) {\n          e.isActive = false;\n          return e;\n        });\n      } else {\n        other_series.map(function (e) {\n          e.isActive = true;\n          return e;\n        });\n      }\n\n      seriesColumn.isActive = false;\n    });\n    /*\r\n    let series1 = createSeries(\"Researchers\");\r\n    series1.data = [\r\n      { x: \"1\", y: \"1\" }\r\n    \r\n    ];\r\n    \r\n    let series2 = createSeries(\"Non-Researchers\");\r\n    series2.data = [\r\n      \r\n    \r\n      { x: \"7\", y: \"1\" }\r\n    ];\r\n    \r\n    var num1 = new Number(0)\r\n    num1 = props.r\r\n    var num2 = new Number(0)\r\n    num2 = props.n\r\n    \r\n    series1.name = \"Researchers: \" + num1.toString();\r\n    series2.name = \"Other: \" + num2.toString();\r\n    \r\n    //var datas = WaffleProportionCheat(num1, num2);\r\n    var datas = WaffleProportionAny([num1, num2]);\r\n    \r\n    //xAxis.data = datas[2];\r\n    //yAxis.data = datas[3];\r\n    \r\n    //series1.data = datas[0];\r\n    //series2.data = datas[1];\r\n    \r\n    series1.data = datas['data_list'][0]\r\n    series2.data = datas['data_list'][1]\r\n    \r\n    xAxis.data = datas['data_x']\r\n    yAxis.data = datas['data_y']\r\n    \r\n    // Legend\r\n    chart.legend = new am4charts.Legend();\r\n    chart.legend.position = \"right\";\r\n    chart.legend.scrollable = true;\r\n    chart.legend.maxWidth = 200;\r\n    \r\n    //Custom code for legend\r\n    chart.legend.itemContainers.template.togglable = false;\r\n    \r\n    var series_dict = {\r\n      [series1.name]: series1['columns']['template'],\r\n      [series2.name]: series2['columns']['template']\r\n    }\r\n    \r\n    var keys = [series1.name, series2.name]\r\n    \r\n    chart.legend.itemContainers.template.events.on(\"hit\", function(ev) {\r\n      let seriesColumn = ev.target.dataItem.dataContext['columns']['template'];\r\n      let sname = ev.target.dataItem.dataContext['name'];\r\n      let other_series = []\r\n      for (let k of keys){\r\n        if (sname != k){\r\n          other_series.push(series_dict[k]);\r\n        }\r\n      }\r\n      if (other_series[0].isActive){\r\n        other_series.map(function(e) { \r\n          e.isActive = false; \r\n          return e;\r\n        });\r\n      } else {\r\n        other_series.map(function(e) { \r\n          e.isActive = true; \r\n          return e;\r\n        });\r\n      }\r\n      seriesColumn.isActive = false;\r\n    });\r\n    \r\n    */\n  }, \"tFi1QeP7MrrEQ5RfFlomBKZonOc=\", false, function () {\n    return [am4core.useTheme];\n  }), []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      id: props.divid,\n      style: {\n        width: \"100%\",\n        height: \"250px\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 470,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 469,\n    columnNumber: 5\n  }, this);\n}\n\n_s2(WaffleChart, \"a4NZWiQVwnDvUnwE0MxHAIGLIqg=\");\n\n_c4 = WaffleChart;\nexport default WaffleChart;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"WaffleProportionAny\");\n$RefreshReg$(_c2, \"WaffleProportionCheat\");\n$RefreshReg$(_c3, \"WaffleProportion\");\n$RefreshReg$(_c4, \"WaffleChart\");","map":{"version":3,"sources":["C:/Users/spenc/Documents/GitHub/hci-com/src/containers/Home/components/WaffleChart.tsx"],"names":["React","useRef","useLayoutEffect","am4core","am4charts","am4themes_animated","user_id","useTheme","WaffleProportionAny","ns","datas","vals","n","push","valueOf","l","length","tot","reduce","a","b","num_cols","parseInt","Math","sqrt","toFixed","max","min","num_cells","nums","last","i","num","strs","rs","row","col","new_data_x","new_data_y","x","toString","y","r_tot","h","data","x_str","y_str","data_list","data_x","data_y","WaffleProportionCheat","m","data1","data2","x_val","y_val","num1","num2","s1","s2","r1","r2","WaffleProportion","WaffleChart","props","chart","nrs","create","divid","XYChart","paddingRight","paddingLeft","hiddenState","properties","opacity","scheme","colors","list","color","xAxis","xAxes","CategoryAxis","dataFields","category","renderer","grid","template","location","minGridDistance","labels","disabled","yAxis","yAxes","createSeries","name","series","ColumnSeries","categoryX","categoryY","sequencedInterpolation","defaultState","transitionDuration","column","columns","strokeWidth","strokeOpacity","fillOpacity","stroke","width","percent","height","hs","states","series_list","vars","nums_list","denom","Number","rat","legend","Legend","scrollable","maxWidth","itemContainers","tooltipText","legend_pos","position","togglable","series_dict","keys","key","events","on","ev","seriesColumn","target","dataItem","dataContext","sname","other_series","k","isActive","map","e"],"mappings":"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","sourcesContent":["import React, { useRef, useLayoutEffect } from 'react';\r\nimport logo from './logo.svg';\r\nimport * as am4core from \"@amcharts/amcharts4/core\";\r\nimport * as am4charts from \"@amcharts/amcharts4/charts\";\r\nimport am4themes_animated from \"@amcharts/amcharts4/themes/animated\";\r\nimport styled from 'styled-components';\r\nimport {space, color, layout} from 'styled-system';\r\nimport Card from 'react-bootstrap/Card';\r\nimport axios from 'axios'\r\n\r\nvar user_id = \"634739719\";\r\n\r\nam4core.useTheme(am4themes_animated);\r\n\r\nfunction WaffleProportionAny(ns: Number[]){\r\n  var datas = [];\r\n  var vals = [];\r\n  for (let n of ns){\r\n    vals.push(n.valueOf());\r\n  }\r\n\r\n  var l = vals.length;\r\n  \r\n  var tot = vals.reduce((a, b) => a + b, 0)\r\n\r\n  var num_cols = parseInt(Math.sqrt((tot / 50)).toFixed());\r\n\r\n  num_cols = Math.max(3, num_cols);\r\n  num_cols = Math.min(30, num_cols)\r\n\r\n  var num_cells = num_cols * num_cols\r\n\r\n  var nums = []\r\n  var last = 0\r\n\r\n  for (let i = 0; i < l; i++){\r\n    var num = vals[i] / tot;\r\n    nums.push(num);\r\n    last = num + last\r\n  }\r\n\r\n  var strs = []\r\n  for (let i = 0; i < l; i++){\r\n    strs.push((nums[i] * num_cells).toFixed());\r\n  }\r\n\r\n  var rs = []\r\n  for (let i = 0; i < l; i++){\r\n    rs.push(parseInt(strs[i]));\r\n  }\r\n\r\n  var row = 1\r\n  var col = 1\r\n\r\n  var new_data_x = [];\r\n  var new_data_y = [];\r\n\r\n  for (let i = 1; i <= num_cols; i++) {\r\n    new_data_x.push({x : i.toString()});\r\n  }\r\n\r\n  for (let i = 1; i <= num_cols; i++) {\r\n    new_data_y.push({y : i.toString()});\r\n  }\r\n\r\n  var r_tot = 0\r\n\r\n  for (let h = 0; h <= (l-1); h++){\r\n    var data = [];\r\n    for (let i = r_tot; i < (r_tot + rs[h]); i++) {\r\n      var x_str = row.toString();\r\n      var y_str = col.toString();\r\n      data.push({ x: x_str, y: y_str});\r\n      if(col == num_cols){\r\n        row = row + 1;\r\n        col = 1\r\n      } else {\r\n        col = col + 1\r\n      }\r\n    }\r\n    datas.push(data)\r\n    r_tot = r_tot + rs[h];\r\n  }\r\n\r\n  var data = [];\r\n  for (let i = r_tot; i < num_cells; i++) {\r\n    var x_str = row.toString();\r\n    var y_str = col.toString();\r\n    data.push({ x: x_str, y: y_str});\r\n    if(col == num_cols){\r\n      row = row + 1;\r\n      col = 1\r\n    } else {\r\n      col = col + 1\r\n    }\r\n  }\r\n  datas.push(data);\r\n\r\n  return({data_list: datas,\r\n          data_x: new_data_x,\r\n          data_y: new_data_y});\r\n}\r\n\r\nfunction WaffleProportionCheat(n: Number, m: Number){\r\n  var data1 = [];\r\n  var data2 = [];\r\n  var x_val = n.valueOf();\r\n  var y_val = m.valueOf();\r\n\r\n  var tot = x_val + y_val;\r\n\r\n  var num_cols = parseInt(Math.sqrt((tot / 50)).toFixed());\r\n\r\n  num_cols = Math.max(3, num_cols);\r\n  num_cols = Math.min(30, num_cols)\r\n\r\n  var num_cells = num_cols * num_cols\r\n\r\n  var num1 = x_val / tot;\r\n  var num2 = 1 - num1;\r\n\r\n  var s1 = (num1 * num_cells).toFixed();\r\n  var s2 = (num2 * num_cells).toFixed();\r\n\r\n  var r1 = parseInt(s1);\r\n  var r2 = parseInt(s2);\r\n\r\n  var row = 1\r\n  var col = 1\r\n\r\n  var new_data_x = [];\r\n  var new_data_y = [];\r\n\r\n  for (let i = 1; i <= num_cols; i++) {\r\n    new_data_x.push({x : i.toString()});\r\n  }\r\n\r\n  for (let i = 1; i <= num_cols; i++) {\r\n    new_data_y.push({y : i.toString()});\r\n  }\r\n\r\n  for (let i = 0; i < r1; i++) {\r\n    var x_str = row.toString();\r\n    var y_str = col.toString();\r\n    data1.push({ x: x_str, y: y_str});\r\n    if(col == num_cols){\r\n      row = row + 1;\r\n      col = 1\r\n    } else {\r\n      col = col + 1\r\n    }\r\n  }\r\n\r\n  for (let i = r1; i < num_cells; i++) {\r\n    var x_str = row.toString();\r\n    var y_str = col.toString();\r\n    data2.push({ x: x_str, y: y_str});\r\n    if(col == num_cols){\r\n      row = row + 1;\r\n      col = 1\r\n    } else {\r\n      col = col + 1\r\n    }\r\n  }\r\n\r\n  return([data1, data2, new_data_x, new_data_y]);\r\n}\r\n\r\nfunction WaffleProportion(n: Number, m: Number){\r\n  var data1 = []\r\n  var data2 = []\r\n  var x_val = n.valueOf();\r\n  var y_val = m.valueOf();\r\n  var tot = x_val + y_val;\r\n  var num1 = x_val / tot;\r\n  var num2 = tot - num1;\r\n\r\n  var s1 = num1.toFixed();\r\n  var s2 = num2.toFixed();\r\n\r\n  var r1 = parseInt(s1);\r\n  var r2 = parseInt(s2);\r\n\r\n  var row = 1\r\n  var col = 1\r\n\r\n  for (let i = 0; i < r1; i++) {\r\n    var x_str = row.toString();\r\n    var y_str = col.toString();\r\n    data1.push({ x: x_str, y: y_str});\r\n    if(col == 10){\r\n      row = row + 1;\r\n      col = 1\r\n    } else {\r\n      col = col + 1\r\n    }\r\n  }\r\n\r\n  for (let i = r1; i < 100; i++) {\r\n    var x_str = row.toString();\r\n    var y_str = col.toString();\r\n    data2.push({ x: x_str, y: y_str});\r\n    if(col == 10){\r\n      row = row + 1;\r\n      col = 1\r\n    } else {\r\n      col = col + 1\r\n    }\r\n  }\r\n\r\n  return([data1, data2]);\r\n}\r\n\r\nfunction WaffleChart(props) {\r\n  const chart = useRef(null);\r\n\r\n  var rs = 3600\r\n  var nrs = 6400\r\n\r\n  useLayoutEffect(() => {\r\n    let x = am4core.create(props.divid, am4charts.XYChart);\r\n\r\n    x.paddingRight = 20;\r\n    x.paddingLeft = 20;\r\n\r\n    /* Chart code */\r\n// Themes begin\r\nam4core.useTheme(am4themes_animated);\r\n// Themes end\r\n\r\n// Chart\r\nlet chart = am4core.create( props.divid, am4charts.XYChart );\r\nchart.hiddenState.properties.opacity = 0; // this creates initial fade-in\r\n//chart.colors.step = 2;\r\nswitch(props.scheme){\r\n  case \"followers\": {\r\n    chart.colors.list = [am4core.color( \"#98a2df\" ), am4core.color( \"#e96b6a\" ), am4core.color(\"#a2df98\")];\r\n    break;\r\n  }\r\n  case \"tweets\": {\r\n    chart.colors.list = [am4core.color( \"#CF30B2\" ), am4core.color( \"#30B2CF\" ), am4core.color(\"#B2CF30\")];\r\n    break;\r\n  }\r\n  default: {\r\n    chart.colors.list = [am4core.color( \"#98a2df\" ), am4core.color( \"#e96b6a\" ), am4core.color(\"#a2df98\")];\r\n  }\r\n}\r\n//chart.colors.list = [am4core.color( \"#98a2df\" ), am4core.color( \"#e96b6a\" ), am4core.color(\"#a2df98\")]\r\n\r\n// X axis\r\nlet xAxis = chart.xAxes.push( new am4charts.CategoryAxis() );\r\nxAxis.dataFields.category = \"x\";\r\nxAxis.renderer.grid.template.location = 0;\r\nxAxis.renderer.minGridDistance = 10;\r\nxAxis.renderer.labels.template.disabled = true;\r\nxAxis.data = [{ x: \"1\" }, { x: \"2\" }, { x: \"3\" }, { x: \"4\" }, { x: \"5\" }, { x: \"6\" }, { x: \"7\" }, { x: \"8\" }, { x: \"9\" }, { x: \"10\" }];\r\n\r\n// Y axis\r\nlet yAxis = chart.yAxes.push( new am4charts.CategoryAxis() );\r\nyAxis.renderer.labels.template.disabled = true;\r\nyAxis.renderer.grid.template.location = 0;\r\nyAxis.renderer.minGridDistance = 10;\r\nyAxis.dataFields.category = \"y\";\r\nyAxis.data = [{ y: \"1\" }, { y: \"2\" }, { y: \"3\" }, { y: \"4\" }, { y: \"5\" }, { y: \"6\" }, { y: \"7\" }, { y: \"8\" }, { y: \"9\" }, { y: \"10\" }];\r\n\r\n// Create series\r\nfunction createSeries(name) {\r\n  let series = chart.series.push( new am4charts.ColumnSeries() );\r\n  series.dataFields.categoryX = \"x\";\r\n  series.dataFields.categoryY = \"y\";\r\n  series.sequencedInterpolation = true;\r\n  series.defaultState.transitionDuration = 3000;\r\n  series.name = name;\r\n\r\n\r\n  // Set up column appearance\r\n  let column = series.columns.template;\r\n  column.strokeWidth = 1;\r\n  column.strokeOpacity = 1;\r\n  column.fillOpacity = 1;\r\n  column.stroke = am4core.color( \"#ffffff\" );\r\n  column.width = am4core.percent( 100 );\r\n  column.height = am4core.percent( 100 );\r\n  //column.column.cornerRadius(6, 6, 6, 6);\r\n\r\n  let hs = series.columns.template.states.create(\"active\");\r\n  hs.properties.fillOpacity = 0.5;\r\n  \r\n  return series;\r\n}\r\n\r\nlet series_list = [];\r\n\r\nlet vars = props.vars\r\n\r\nlet nums_list = [];\r\n\r\nlet denom = 0;\r\n\r\nfor (let i = 0; i < vars.length; i++){\r\n  var num = new Number();\r\n  num = vars[i]['data'];\r\n  denom = denom + vars[i]['data'];\r\n  nums_list.push(num);\r\n}\r\n\r\nfor (let i = 0; i < vars.length; i++){\r\n  var percent = vars[i]['data']/denom;\r\n  var rat = (percent * 100).toFixed(1).toString();\r\n  series_list.push(createSeries(vars[i]['name'] + \": \" + rat + \"% (\"  + nums_list[i].toString() + \")\" ));\r\n}\r\n\r\nvar datas = WaffleProportionAny(nums_list);\r\n\r\nfor (let i = 0; i < vars.length; i++){\r\n  series_list[i].data = datas['data_list'][i]\r\n}\r\n\r\nxAxis.data = datas['data_x']\r\nyAxis.data = datas['data_y']\r\n\r\n// Legend\r\nchart.legend = new am4charts.Legend();\r\nchart.legend.scrollable = true;\r\nchart.legend.maxWidth = 50;\r\nchart.legend.itemContainers.template.tooltipText = \"{name}\";\r\n\r\nswitch(props.legend_pos){\r\n  case \"right\": {\r\n    chart.legend.position = \"right\";\r\n    break;\r\n  }\r\n  case \"left\": {\r\n    chart.legend.position = \"left\";\r\n    break;\r\n  }\r\n  case \"top\": {\r\n    chart.legend.position = \"top\";\r\n    break;\r\n  }\r\n  case \"bottom\": {\r\n    chart.legend.position = \"bottom\";\r\n    break;\r\n  }\r\n  default: {\r\n    chart.legend.position = \"right\";\r\n    break;\r\n  }\r\n}\r\n\r\n//Custom code for legend\r\nchart.legend.itemContainers.template.togglable = false;\r\n\r\nvar series_dict = {}\r\nvar keys = [];\r\n\r\nfor (let i = 0; i < vars.length; i++){\r\n  var key = series_list[i].name;\r\n  series_dict[key] = series_list[i]['columns']['template'];\r\n  keys.push(key);\r\n}\r\n\r\nchart.legend.itemContainers.template.events.on(\"hit\", function(ev) {\r\n  let seriesColumn = ev.target.dataItem.dataContext['columns']['template'];\r\n  let sname = ev.target.dataItem.dataContext['name'];\r\n  let other_series = []\r\n  for (let k of keys){\r\n    if (sname != k){\r\n      other_series.push(series_dict[k]);\r\n    }\r\n  }\r\n  if (other_series[0].isActive){\r\n    other_series.map(function(e) { \r\n      e.isActive = false; \r\n      return e;\r\n    });\r\n  } else {\r\n    other_series.map(function(e) { \r\n      e.isActive = true; \r\n      return e;\r\n    });\r\n  }\r\n  seriesColumn.isActive = false;\r\n});\r\n\r\n/*\r\nlet series1 = createSeries(\"Researchers\");\r\nseries1.data = [\r\n  { x: \"1\", y: \"1\" }\r\n\r\n];\r\n\r\nlet series2 = createSeries(\"Non-Researchers\");\r\nseries2.data = [\r\n  \r\n\r\n  { x: \"7\", y: \"1\" }\r\n];\r\n\r\nvar num1 = new Number(0)\r\nnum1 = props.r\r\nvar num2 = new Number(0)\r\nnum2 = props.n\r\n\r\nseries1.name = \"Researchers: \" + num1.toString();\r\nseries2.name = \"Other: \" + num2.toString();\r\n\r\n//var datas = WaffleProportionCheat(num1, num2);\r\nvar datas = WaffleProportionAny([num1, num2]);\r\n\r\n//xAxis.data = datas[2];\r\n//yAxis.data = datas[3];\r\n\r\n//series1.data = datas[0];\r\n//series2.data = datas[1];\r\n\r\nseries1.data = datas['data_list'][0]\r\nseries2.data = datas['data_list'][1]\r\n\r\nxAxis.data = datas['data_x']\r\nyAxis.data = datas['data_y']\r\n\r\n// Legend\r\nchart.legend = new am4charts.Legend();\r\nchart.legend.position = \"right\";\r\nchart.legend.scrollable = true;\r\nchart.legend.maxWidth = 200;\r\n\r\n//Custom code for legend\r\nchart.legend.itemContainers.template.togglable = false;\r\n\r\nvar series_dict = {\r\n  [series1.name]: series1['columns']['template'],\r\n  [series2.name]: series2['columns']['template']\r\n}\r\n\r\nvar keys = [series1.name, series2.name]\r\n\r\nchart.legend.itemContainers.template.events.on(\"hit\", function(ev) {\r\n  let seriesColumn = ev.target.dataItem.dataContext['columns']['template'];\r\n  let sname = ev.target.dataItem.dataContext['name'];\r\n  let other_series = []\r\n  for (let k of keys){\r\n    if (sname != k){\r\n      other_series.push(series_dict[k]);\r\n    }\r\n  }\r\n  if (other_series[0].isActive){\r\n    other_series.map(function(e) { \r\n      e.isActive = false; \r\n      return e;\r\n    });\r\n  } else {\r\n    other_series.map(function(e) { \r\n      e.isActive = true; \r\n      return e;\r\n    });\r\n  }\r\n  seriesColumn.isActive = false;\r\n});\r\n\r\n*/\r\n\r\n\r\n\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n        <div id={props.divid} style={{ width: \"100%\", height: \"250px\" }}></div>\r\n    </div>\r\n    \r\n  );\r\n}\r\nexport default WaffleChart;"]},"metadata":{},"sourceType":"module"}